<% @hoonta = get_hoonta %>
<% rosters = Roster.where(hoonta_id: @hoonta.id) %>
<% if rosters.kind_of?(Roster) %>
  rosters = [User.find(rosters.user_id)]
<% end %>
<h4 class="sub-headline"><%=@hoonta.hoonta_name%></h4>
<%= handle_message %>
<div class="row">
  <div class="four columns u-full-width">
    <h5>Topic</h5>
  </div>
  <div class="four columns u-full-width">
    <h5>Category</h5>
  </div>
  <div class="four columns u-full-width">
    <h5>Deadline</h5>
  </div>
</div>

<% @topics = Topic.where(hoonta_id: @hoonta.id) %>
<% if not @topics.empty? %>
  <% @topics.each do |topic| %>
    <% category = Category.find(topic.category_id).category_name %>
    <form action="/topic" method="get" class="thin">
      <input hidden type="text" name="id" value="<%= topic.id %>">
      <div class="row topic-row" onclick="javascript:this.parentNode.submit()">
        <div class="four columns u-full-width">
          <%= topic.topic_name %>
        </div>
        <div class="four columns u-full-width">
          <%= category %>
        </div>
        <div class="four columns u-full-width">
          <%= topic.deadline %>
        </div>
      </div>
    </form>
    <% end %>
<% end %>

<div class="roomy row">
  <a href="/topic/create">Create a topic</a>
</div>

<h5>Members</h5>
<div class="row">
  <% rosters.each do |roster| %>
    <div class="two columns user-box roomy">
      <%= User.find(roster.user_id).user_name %>
    </div>
  <% end %>
</div>
